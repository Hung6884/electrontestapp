Background Remover (Electron + React, ERB) — Ứng dụng Electron (dựa trên electron-react-boilerplate / ERB) để xoá nền ảnh qua API. Hỗ trợ kéo-thả, Ctrl+V dán ảnh, xem trước/sau, tải về, UI mượt và có cuộn.
 1) YÊU CẦU MÔI TRƯỜNG: Node.js ≥ 18; Yarn (khuyên dùng: chạy lệnh npm i -g yarn); Windows 10/11 để build .exe (macOS/Linux build tương tự, chỉ khác target). 
 2) CÀI ĐẶT & CHẠY DEV: trong thư mục dự án chạy lần lượt: “yarn” rồi “yarn start”. ERB sẽ mở app Electron ở chế độ dev (HMR). Renderer là React; Main + Preload dùng TypeScript/Webpack theo cấu trúc ERB. 
 3) CÁCH DÙNG: Chọn ảnh bằng upload/kéo-thả/nhấn Ctrl+V để dán ảnh từ clipboard. Nhấn “Remove Background”: Renderer gọi IPC → Main gọi HTTP API → trả về ảnh kết quả (dạng dataURL/base64 hoặc đường dẫn file, tuỳ bạn triển khai). Có nút tải xuống kết quả. 
 Lưu ý rất quan trọng: Không gọi API HTTP trực tiếp từ Renderer (Chromium sẽ dính CORS). Hãy để Main process (Node) gọi API và trả kết quả về Renderer qua IPC. IPC contract ví dụ: Renderer gọi “await window.electron.ipcRenderer.invoke('remove-background', dataUrl)” và kỳ vọng nhận về “{ success: boolean, data?: string /* dataURL/base64 */, error?: string }”. 
 4) BUILD FILE CÀI ĐẶT .EXE (WINDOWS): chạy “yarn package”. Sau khi xong, file cài đặt nằm tại “release/build/ElectronReact Setup <version>.exe”. Nhấp đúp để cài như ứng dụng Windows bình thường. Tuỳ chọn build portable (không cần cài): “yarn package --win portable”. 
 5) ĐỔI TÊN APP & ICON (TUỲ CHỌN): trong package.json, trường “build” đặt appId, productName, output, win.target, win.icon (assets/icon.ico 256×256), nsis.oneClick và nsis.allowToChangeInstallationDirectory; sau đó “yarn package” lại. 
 6) CẤU TRÚC DỰ ÁN RÚT GỌN: “src/main/” (Electron Main – nơi gọi HTTP ra ngoài, không bị CORS), “src/preload/” (bridge an toàn, contextIsolation), “src/renderer/” (React UI), “.erb/” (config/scripts của ERB), “release/” (output khi package), “package.json”. 
 7) SCRIPTS CHÍNH: “yarn start” chạy dev; “yarn build” build production (main + renderer); “yarn package” đóng gói tạo .exe; “npm run build:dll” bundle DLL phục vụ dev (tùy chọn, có thể bỏ qua khi package). Nếu muốn “yarn package” không chạy build:dll, sửa script trong package.json để bỏ “&& npm run build:dll”. 
 8) BẢO MẬT KHUYẾN NGHỊ: giữ “contextIsolation: true”, “nodeIntegration: false”; chỉ expose qua preload đúng các API cần; không cho Renderer truyền URL tuỳ ý qua IPC (tránh SSRF); luôn đặt call HTTP ở Main. 
 9) TROUBLESHOOTING: 
 (A) Renderer báo “Failed to fetch / CORS”: nguyên nhân do Renderer = Chromium nên bị CORS (multipart còn có preflight OPTIONS). Cách xử lý: đưa call HTTP sang Main process và trả kết quả qua IPC. 
 (B) Build Windows lỗi symlink (winCodeSign) với log “ERROR: Cannot create symbolic link : A required privilege is not held by the client.”: bật Developer Mode (Settings → Privacy & Security → For developers → bật Developer Mode) hoặc mở terminal Run as Administrator; sau đó xoá cache và build lại bằng “rmdir /s /q "%LOCALAPPDATA%\electron-builder\Cache\winCodeSign"” rồi “yarn package”. 
 (C) Lỗi notarize trên Windows (hook macOS của ERB) với log “Unable to require .erb/scripts/notarize.js (ESM)”: mở package.json → build → xoá dòng “afterSign”: “.erb/scripts/notarize.js”; hoặc sửa file notarize.js để “if (process.platform !== 'darwin') return;” và dùng dynamic import: “const { notarize } = await import('@electron/notarize')”. 
 (D) “build:dll” báo thiếu @types/node-fetch với log “Module not found: Can't resolve '@types/node-fetch'”: cài “yarn add -D @types/node-fetch@2” (hoặc npm i -D @types/node-fetch@2); hoặc bỏ hẳn bước DLL khi package như đã nói ở phần scripts. 
 (E) Cảnh báo “Browserslist data is old”: có thể bỏ qua; nếu muốn cập nhật chạy “npx update-browserslist-db@latest”. 
 (F) Log “no signing info identified, signing is skipped”: bạn chưa cấu hình code signing; app vẫn chạy bình thường, nhưng Windows có thể hiện SmartScreen “Unknown publisher”. 
 10) FAQ: Vì sao Main gọi API không bị CORS? Vì CORS là chính sách của trình duyệt, Main là Node.js nên không áp dụng CORS. File .exe sau build ở đâu? Ở “release/build/<ProductName> Setup <version>.exe”. Vì sao icon không đổi trong dev? Icon chỉ áp dụng khi đóng gói, chạy “yarn package” để thấy icon mới trong installer.